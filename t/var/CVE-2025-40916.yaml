# yaml-language-server: $schema=../../schema/cpansec-cna-schema-01.yaml
cpansec:
  cve: CVE-2025-40916

  distribution: Mojolicious-Plugin-CaptchaPNG
  module: Mojolicious::Plugin::CaptchaPNG
  author: GRYPHON
  repo: https://github.com/gryphonshafer/Mojo-Plugin-CaptchaPNG

  affected:
    - "1.05"

  title: |
    Mojolicious::Plugin::CaptchaPNG version 1.05 for Perl uses a weak random
    number source for generating the captcha text

  description: |
    Mojolicious::Plugin::CaptchaPNG version 1.05 for Perl uses a weak random
    number source for generating the captcha.

    That version uses the built-in rand() function for generating the captcha
    text as well as image noise, which is insecure.

  cwes:
    - CWE-338 Use of Cryptographically Weak Pseudo-Random Number Generator
    - CWE-804 Guessable CAPTCHA

  solution: |
    Users should upgrade to version 1.06 or later.

  references:
    - link: https://metacpan.org/release/GRYPHON/Mojolicious-Plugin-CaptchaPNG-1.04/diff/GRYPHON/Mojolicious-Plugin-CaptchaPNG-1.05/lib/Mojolicious/Plugin/CaptchaPNG.pm
    - link: https://metacpan.org/release/GRYPHON/Mojolicious-Plugin-CaptchaPNG-1.06/changes
    - link: https://metacpan.org/pod/perlfunc#rand
    - link: https://security.metacpan.org/docs/guides/random-data-for-security.html
