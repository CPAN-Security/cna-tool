use strict;
use v5.42;

use JSON::PP qw(decode_json);
use Test::More;

use lib 'lib';
use CPANSec::CVE ();

my $cve = CPANSec::CVE->from_yaml_file('t/var/CVE-2025-40916.yaml');

is($cve->cve_id, 'CVE-2025-40916', 'facade exposes CVE id');
$cve->validate;
pass('facade validate succeeds');

my $full = decode_json($cve->to_cve5_json);
is($full->{cveMetadata}{cveId}, 'CVE-2025-40916', 'facade renders CVE JSON record');

my $cna = decode_json($cve->to_cna_container_json);
ok(ref($cna->{affected}) eq 'ARRAY', 'facade renders CNA container JSON');

done_testing();
